<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lauro Reyes Rosas - 214532">
<meta name="dcterms.date" content="2024-10-10">

<title>Práctica 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="practica_1_files/libs/clipboard/clipboard.min.js"></script>
<script src="practica_1_files/libs/quarto-html/quarto.js"></script>
<script src="practica_1_files/libs/quarto-html/popper.min.js"></script>
<script src="practica_1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="practica_1_files/libs/quarto-html/anchor.min.js"></script>
<link href="practica_1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="practica_1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="practica_1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="practica_1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="practica_1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Práctica 1</h1>
<p class="subtitle lead">ITAM - Métodos Numéricos y Optimización (MAT-34420)</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lauro Reyes Rosas - 214532 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 10, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Una función implítica es una función de la forma: <span class="math display">\[F(x,y) = 0\]</span> Las funciones implícitas se pueden utilizar para modelar objetos geométricos. Así, un objeto geométrico puede estar definido en términos de <span class="math inline">\(F : \mathbb{R}^2 \rightarrow \mathbb{R}\)</span> como: <span class="math display">\[\mathcal{G} = \left\{ (x, y) \in \mathbb{R}^2 \mid F(x, y) \leq 0 \right\} \subset \mathbb{R}^2.\]</span></p>
<p>Considera la región <span class="math inline">\(\mathcal{G}\)</span> determinada por la función: <span class="math display">\[F(x,y) = (x^2+y−10)^2+(x+y^2−12)^2 −100\]</span></p>
<section id="calcular-bounding-box" class="level3">
<h3 class="anchored" data-anchor-id="calcular-bounding-box">Calcular <em>Bounding Box</em></h3>
<p>Ya que es una función que se puede representar en el plano cartesiano, para calcular el <em>bounding box</em> se hará de forma visual empezando por -10 a 10 ya que AHHHHHH</p>
<p><strong>Definimos la función F(x, y)</strong></p>
<div id="98f4b0a1" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> F(x, y):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y <span class="op">-</span> <span class="dv">10</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (x <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">12</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Creamos gráfica para ver límites</strong></p>
<div id="421d06fc" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">200</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">200</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular F en todos los puntos de la malla</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> F(X, Y)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear la gráfica </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>contour <span class="op">=</span> plt.contour(X, Y, Z, levels<span class="op">=</span>[<span class="dv">0</span>], colors<span class="op">=</span><span class="st">'red'</span>)  <span class="co"># Dibujar el contorno donde F(x, y) = 0</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>plt.clabel(contour, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="vs">r"Contorno de la función $F(x, y) = 0$"</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"X"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y"</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>,linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>,linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practica_1_files/figure-html/cell-4-output-1.png" width="698" height="525" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Al ver la gráfica podemos ver que un bounding box correcto, agregando un ligero margen, sería el cuadrado de <span class="math inline">\(x \in [-6,6]\)</span> y <span class="math inline">\(y \in [-6,6]\)</span></p>
</section>
<section id="estimación-de-área-por-montecarlo" class="level3">
<h3 class="anchored" data-anchor-id="estimación-de-área-por-montecarlo">Estimación de área por Montecarlo</h3>
<p>La estimación de área por Monte Carlo es un método que usa puntos generados al azar para aproximar el área de una figura. Podemos verlo como lanzar muchos puntos dentro de un rectángulo que rodea la figura. Luego, cuentas cuántos puntos caen dentro de la figura y cuántos fuera. Con esa proporción, multiplicada por el área del rectángulo, puedes calcular el área aproximada de la figura, incluso si su forma es irregular.</p>
<p>Primero graficamos cómo se vería esta definición con <span class="math inline">\(10^5\)</span> muestras:</p>
<div id="d1ca6076" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definimos el bounding box</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x_min, x_max <span class="op">=</span> <span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>y_min, y_max <span class="op">=</span> <span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>bounding_box_area <span class="op">=</span> (x_max <span class="op">-</span> x_min) <span class="op">*</span> (y_max <span class="op">-</span> y_min)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># gráfica</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>num_points <span class="op">=</span> <span class="dv">10</span><span class="op">**</span><span class="dv">5</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># puntos aleatorios</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>x_random <span class="op">=</span> np.random.uniform(x_min, x_max, num_points)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>y_random <span class="op">=</span> np.random.uniform(y_min, y_max, num_points)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>F_values <span class="op">=</span> F(x_random, y_random)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># nos quedamos con los valores F(x, y) &lt;= 0</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>points_inside <span class="op">=</span> F_values <span class="op">&lt;=</span> <span class="dv">0</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>area_fraction <span class="op">=</span> np.<span class="bu">sum</span>(points_inside) <span class="op">/</span> num_points</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>estimated_area <span class="op">=</span> bounding_box_area <span class="op">*</span> area_fraction</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización de los puntos</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>plt.scatter(x_random, y_random, c<span class="op">=</span>points_inside, s<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Monte Carlo Estimation of Area: </span><span class="sc">{</span>estimated_area<span class="sc">:.2f}</span><span class="ss"> con $10^5$ muestras"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"x"</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"y"</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practica_1_files/figure-html/cell-5-output-1.png" width="662" height="673" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>después de ver cómo se representa en el plano calculamos el área de <span class="math inline">\(\mathcal{G}\)</span> usando el método de Monte Carlo con <span class="math inline">\(10^2,10^3,...,10^8\)</span> muestras.</p>
<div id="e0dcac9b" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">44</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>exp <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>,<span class="dv">9</span>)]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>frames <span class="op">=</span> []</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> exp:</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    num_points <span class="op">=</span> <span class="dv">10</span><span class="op">**</span>i</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    x_random <span class="op">=</span> np.random.uniform(x_min, x_max, num_points)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    y_random <span class="op">=</span> np.random.uniform(y_min, y_max, num_points)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    F_values <span class="op">=</span> F(x_random, y_random)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    points_inside <span class="op">=</span> F_values <span class="op">&lt;=</span> <span class="dv">0</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Área estimada</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    area_fraction <span class="op">=</span> np.<span class="bu">sum</span>(points_inside) <span class="op">/</span> num_points</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    estimated_area <span class="op">=</span> bounding_box_area <span class="op">*</span> area_fraction</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># guardar info</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    frames.append({<span class="st">"muestras"</span>:num_points,<span class="st">"area_estimada"</span>:estimated_area})</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>estimated_area_df <span class="op">=</span> pd.DataFrame(frames)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>estimated_area_df.style.<span class="bu">format</span>({</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'muestras'</span>: <span class="st">'</span><span class="sc">{:.0e}</span><span class="st">'</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'area_estimada'</span>: <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<style type="text/css">
</style>

<table id="T_4581b" class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_4581b_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">muestras</th>
<th id="T_4581b_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">area_estimada</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_4581b_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_4581b_row0_col0" class="data row0 col0">1e+02</td>
<td id="T_4581b_row0_col1" class="data row0 col1">33.12</td>
</tr>
<tr class="even">
<td id="T_4581b_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_4581b_row1_col0" class="data row1 col0">1e+03</td>
<td id="T_4581b_row1_col1" class="data row1 col1">41.90</td>
</tr>
<tr class="odd">
<td id="T_4581b_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_4581b_row2_col0" class="data row2 col0">1e+04</td>
<td id="T_4581b_row2_col1" class="data row2 col1">39.08</td>
</tr>
<tr class="even">
<td id="T_4581b_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_4581b_row3_col0" class="data row3 col0">1e+05</td>
<td id="T_4581b_row3_col1" class="data row3 col1">38.96</td>
</tr>
<tr class="odd">
<td id="T_4581b_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_4581b_row4_col0" class="data row4 col0">1e+06</td>
<td id="T_4581b_row4_col1" class="data row4 col1">38.81</td>
</tr>
<tr class="even">
<td id="T_4581b_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_4581b_row5_col0" class="data row5 col0">1e+07</td>
<td id="T_4581b_row5_col1" class="data row5 col1">38.76</td>
</tr>
<tr class="odd">
<td id="T_4581b_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_4581b_row6_col0" class="data row6 col0">1e+08</td>
<td id="T_4581b_row6_col1" class="data row6 col1">38.77</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Vemos que mientras más puntos mejor es nuestra aproximación del área dando un área de <strong>38.77</strong> unidades cuadradas con <span class="math inline">\(10^8\)</span> muestras.</p>
</section>
<section id="estimación-de-área-con-método-recursivo" class="level3">
<h3 class="anchored" data-anchor-id="estimación-de-área-con-método-recursivo">Estimación de área con método recursivo</h3>
<p>En este caso calculamos el valor de <span class="math inline">\(F(x,y)\)</span> en las esquinas del <em>bounding box</em>, en este caso todo va estar fuera de <span class="math inline">\(\mathcal{G}\)</span> eya que le dimos un margen, y al tener todas las esquinas fuera de <span class="math inline">\(\mathcal{G}\)</span> se volvera a calcular pero dividiendo el cuadrado en cuatro partes y se volverá a calcular las esquinas hasta llegar a la profundid máxima, una vez que se llega a la profundidad máxima se hará un montecarlo para ajustar el área de es subconjunto que no vamos a volver a dividir.</p>
<div id="bc8b8306" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> polygon_area(xlims, ylims):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""calcula el área de un rectángulo basado en sus coordenadas"""</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> <span class="bu">abs</span>(xlims[<span class="dv">1</span>] <span class="op">-</span> xlims[<span class="dv">0</span>])</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> <span class="bu">abs</span>(ylims[<span class="dv">1</span>] <span class="op">-</span> ylims[<span class="dv">0</span>])</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    area <span class="op">=</span> b <span class="op">*</span> h</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> area</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recursive_plot(fun,xlims,ylims,maxdepth<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Cálculo de área con método recursivo más gráfico explicativo</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">    fun - función implícita</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">    xlims - límites en x, array [xmin, xmax]</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">    ylims - límites en y, array [ymin, ymax]</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">    maxdepth - profundidad máxima de recursión"""</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cálculo montecarlo</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.random.uniform(xlims[<span class="dv">0</span>], xlims[<span class="dv">1</span>], n)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.random.uniform(ylims[<span class="dv">0</span>], ylims[<span class="dv">1</span>], n)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cálculo de cuadrado</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    polyx <span class="op">=</span> np.array([xlims[<span class="dv">0</span>], xlims[<span class="dv">0</span>], xlims[<span class="dv">1</span>], xlims[<span class="dv">1</span>], xlims[<span class="dv">0</span>]])</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    polyy <span class="op">=</span> np.array([ylims[<span class="dv">0</span>], ylims[<span class="dv">1</span>], ylims[<span class="dv">1</span>], ylims[<span class="dv">0</span>], ylims[<span class="dv">0</span>]])</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    corners <span class="op">=</span> np.array([<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> np.array([<span class="dv">0</span>,<span class="dv">1</span>]):</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> np.array([<span class="dv">0</span>,<span class="dv">1</span>]):</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>            corners[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span>j] <span class="op">=</span> sign(fun(xlims[i],ylims[j]))</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> np.<span class="bu">all</span>(np.array(corners) <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># todo el conjunto esta en G</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        plt.fill( polyx, polyy, color<span class="op">=</span><span class="st">'purple'</span>,linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">"k"</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> polygon_area(xlims, ylims)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> np.<span class="bu">all</span>(np.array(corners) <span class="op">==</span> <span class="dv">1</span>):</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># todo el conjunto está afuera</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># revisar si tiene parte de la función</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        suc <span class="op">=</span> np.<span class="bu">sum</span>(fun(x,y) <span class="op">&lt;=</span> <span class="dv">0</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> suc <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>            <span class="co"># si la función esta en el conjunto subdividir y volver a evaluar</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>            xmid <span class="op">=</span> (xlims[<span class="dv">0</span>]<span class="op">+</span>xlims[<span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>            ymid <span class="op">=</span> (ylims[<span class="dv">0</span>]<span class="op">+</span>ylims[<span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>            result <span class="op">+=</span> recursive_plot(fun,[xlims[<span class="dv">0</span>],xmid],[ylims[<span class="dv">0</span>],ymid],maxdepth<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>            result <span class="op">+=</span> recursive_plot(fun,[xmid,xlims[<span class="dv">1</span>]],[ylims[<span class="dv">0</span>],ymid],maxdepth<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>            result <span class="op">+=</span> recursive_plot(fun,[xlims[<span class="dv">0</span>],xmid],[ymid,ylims[<span class="dv">1</span>]],maxdepth<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>            result <span class="op">+=</span> recursive_plot(fun,[xmid,xlims[<span class="dv">1</span>]],[ymid,ylims[<span class="dv">1</span>]],maxdepth<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>            <span class="co"># si no hay parte de la función colorear de gris</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>            plt.fill( polyx, polyy,</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>                linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">"k"</span>, color<span class="op">=</span><span class="st">'gray'</span>,alpha<span class="op">=</span><span class="fl">0.4</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> maxdepth <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># si llegó a la máxima profundidad terminar con montecarlo</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>        suc <span class="op">=</span> np.<span class="bu">sum</span>(fun(x,y) <span class="op">&lt;=</span> <span class="dv">0</span>)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>        plt.fill( polyx, polyy, color<span class="op">=</span><span class="st">'brown'</span>,linewidth<span class="op">=</span><span class="fl">0.5</span>, edgecolor<span class="op">=</span><span class="st">"k"</span>)</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> (polygon_area(xlims, ylims) <span class="op">*</span> (suc<span class="op">/</span>n))</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># si la función tiene partes en G y otras no subdividir y volver a evaluar</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>        xmid <span class="op">=</span> (xlims[<span class="dv">0</span>]<span class="op">+</span>xlims[<span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>        ymid <span class="op">=</span> (ylims[<span class="dv">0</span>]<span class="op">+</span>ylims[<span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> recursive_plot(fun,[xlims[<span class="dv">0</span>],xmid],[ylims[<span class="dv">0</span>],ymid],maxdepth<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> recursive_plot(fun,[xmid,xlims[<span class="dv">1</span>]],[ylims[<span class="dv">0</span>],ymid],maxdepth<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> recursive_plot(fun,[xlims[<span class="dv">0</span>],xmid],[ymid,ylims[<span class="dv">1</span>]],maxdepth<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> recursive_plot(fun,[xmid,xlims[<span class="dv">1</span>]],[ymid,ylims[<span class="dv">1</span>]],maxdepth<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Graficamos la función donde el morado es los subconjuntos que detecto que pertenecen a <span class="math inline">\(\mathcal{G}\)</span> y los cafes los aproximo por <em>montecarlo</em>.</p>
<div id="8256c897" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">44</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure( figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>) )</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> recursive_plot(F,[<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>],[<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>],<span class="dv">7</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'equal'</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Area = </span><span class="sc">{</span>result<span class="sc">:-2f}</span><span class="ss">"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practica_1_files/figure-html/cell-8-output-1.png" width="792" height="801" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Vemos que el área estimada es muy similar que estimando todo por montecarlo <strong>38.77</strong> unidades cuadradas</p>
</section>
<section id="cálculo-de-probabilidades" class="level3">
<h3 class="anchored" data-anchor-id="cálculo-de-probabilidades">Cálculo de probabilidades</h3>
<section id="caso-de-normal-bivariada" class="level4">
<h4 class="anchored" data-anchor-id="caso-de-normal-bivariada">Caso de normal bivariada</h4>
<p>Calculamos la probabilidad de que un punto aleatorio <span class="math inline">\((x,y)\)</span> esté en la región <span class="math inline">\(\mathcal{G}\)</span>. Las componentes de <span class="math inline">\((x, y) \in \mathbb{R}^2\)</span> se distribuyen como normal bivariada con medias <span class="math inline">\(\mu_x,\mu_y\)</span>, desviaciones estándar <span class="math inline">\(\sigma_x,\sigma_y\)</span>, y correlación <span class="math inline">\(p_{xy}\)</span>. <span class="math display">\[\mathbb{P}[(x, y) \in \mathcal{G}] =?\]</span></p>
<p><strong>Integral para calcular esta probabilidad.</strong></p>
<p>La función de densidad conjunta de la distribución normal bivariada es <span class="math display">\[
f(x, y) = \frac{1}{2\pi\sigma_X\sigma_Y\sqrt{1-\rho^2}} \exp \left( -\frac{1}{2(1-\rho^2)} \left[ \frac{(x-\mu_X)^2}{\sigma_X^2} + \frac{(y-\mu_Y)^2}{\sigma_Y^2} - 2\rho\frac{(x-\mu_X)(y-\mu_Y)}{\sigma_X\sigma_Y} \right] \right)
\]</span></p>
<p>Dando un integral de</p>
<p><span class="math display">\[
\mathbb{P}[(x,y) \in \mathcal{G}] = \iint_{\mathcal{G}} \frac{1}{2\pi\sigma_X\sigma_Y\sqrt{1-\rho^2}} \exp \left( -\frac{1}{2(1-\rho^2)} \left[ \frac{(x-\mu_X)^2}{\sigma_X^2} + \frac{(y-\mu_Y)^2}{\sigma_Y^2} - 2\rho\frac{(x-\mu_X)(y-\mu_Y)}{\sigma_X\sigma_Y} \right] \right) \, dx \, dy
\]</span></p>
<p><strong>Montecarlo</strong>: En este caso por la complejidad de la integral podemos usar Montecarlo para estimar el valor de <span class="math inline">\(\mathcal{G}\)</span>, para esto se generan múltiples muestras <span class="math inline">\((x,y)\)</span> con la distribución normal bivariada especificada (con medias <span class="math inline">\(\mu_x,\mu_y\)</span>, desviaciones estándar <span class="math inline">\(\sigma_x,\sigma_y\)</span>​, y correlación <span class="math inline">\(p_{xy}\)</span>​). Luego, se evalúa la función <span class="math inline">\(F(x,y)\)</span> para determinar si cada muestra cae dentro de la región <span class="math inline">\(\mathcal{G}\)</span>. La probabilidad se estima como la proporción de muestras que cumplen <span class="math inline">\(F(x,y)≤0\)</span> respecto al total de muestras generadas.</p>
<p>Calculamos montecarlo con muestras <span class="math inline">\(10^2, 10^3, . . . , 10^8\)</span> suponiendo que las componentes de <span class="math inline">\((x, y) \in \mathbb{R}^2\)</span> se distribuyen como normal bivariada con <span class="math inline">\(\mu_x = \mu_y \in \{−6, −5, . . . , 5, 6\}\)</span>, <span class="math inline">\(\sigma_x = \sigma_y \in \{1,2,3,4,5\}\)</span> y <span class="math inline">\(p_{xy} = 0\)</span></p>
<div id="90c3836c" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calcular_probabilidad_region(N, mu_x, mu_y, sigma_x, sigma_y, p_xy, F):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Calcula la probabilidad de que (x, y) esté en la región G utilizando Monte Carlo.</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">        N (int): Número de muestras aleatorias a generar.</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">        mu_x (float): Media de la distribución en el eje x.</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">        mu_y (float): Media de la distribución en el eje y.</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">        sigma_x (float): Desviación estándar en el eje x.</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">        sigma_y (float): Desviación estándar en el eje y.</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">        p_xy (float): Correlación entre x e y.</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">        F (function): Función que define la región G (retorna True si está en la región).</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">        float: Probabilidad estimada de que (x, y) esté en la región G.</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Matriz de covarianza para la normal bivariada</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    cov_matrix <span class="op">=</span> [[sigma_x<span class="op">**</span><span class="dv">2</span>, p_xy <span class="op">*</span> sigma_x <span class="op">*</span> sigma_y],</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                  [p_xy <span class="op">*</span> sigma_x <span class="op">*</span> sigma_y, sigma_y<span class="op">**</span><span class="dv">2</span>]]</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generar N muestras aleatorias de la normal bivariada</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    muestras <span class="op">=</span> np.random.multivariate_normal([mu_x, mu_y], cov_matrix, N)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.<span class="bu">sum</span>(np.array(F(muestras[:, <span class="dv">0</span>], muestras[:, <span class="dv">1</span>])) <span class="op">&lt;=</span> <span class="dv">0</span>) <span class="op">/</span> <span class="bu">len</span>(muestras)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>mus <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">1</span>)    <span class="co"># Medias mu_x y mu_y de -6 a 6</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>sigmas <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]     <span class="co"># Desviaciones estándar sigma_x y sigma_y</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>p_xy <span class="op">=</span> <span class="dv">0</span>                     <span class="co"># Correlación entre x e y</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>N_values <span class="op">=</span> [<span class="dv">10</span><span class="op">**</span>i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">9</span>)]  <span class="co"># Valores de N = 10^2, 10^3, ..., 10^8</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co"># DataFrame para guardar los resultados</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>frames <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular la probabilidad para cada combinación de parámetros</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> mu_x <span class="kw">in</span> mus:</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    mu_y <span class="op">=</span> mu_x</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sigma_x <span class="kw">in</span> sigmas:</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>        sigma_y <span class="op">=</span> sigma_x  <span class="co"># Igualar sigma_x y sigma_y</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> N <span class="kw">in</span> N_values:</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>            probabilidad <span class="op">=</span> calcular_probabilidad_region(N, mu_x, mu_y, sigma_x, sigma_y, p_xy, F)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>            frames.append({<span class="st">"N"</span>:N, <span class="st">"mu_x"</span>:mu_x, <span class="st">"mu_y"</span>:mu_y, <span class="st">"sigma_x"</span>:sigma_x, </span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"sigma_y"</span>:sigma_y, <span class="st">"probabilidad"</span>:probabilidad})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="distribuciones-con-mayor-probabilidad" class="level5">
<h5 class="anchored" data-anchor-id="distribuciones-con-mayor-probabilidad">Distribuciones con mayor probabilidad</h5>
<p>Vemos que las distribuciones con mayor probabilidad son</p>
<div id="e2a6cc32" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>top_probs <span class="op">=</span> (</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    pd.DataFrame(frames)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">'probabilidad'</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    .drop_duplicates(subset<span class="op">=</span>[<span class="st">'mu_x'</span>,<span class="st">'mu_y'</span>,<span class="st">'sigma_x'</span>,<span class="st">'sigma_y'</span>])</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">4</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>top_probs.style.<span class="bu">format</span>({</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'probabilidad'</span>: <span class="st">'</span><span class="sc">{:.4f}</span><span class="st">'</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'N'</span>: <span class="st">'</span><span class="sc">{:.1e}</span><span class="st">'</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<style type="text/css">
</style>

<table id="T_60574" class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_60574_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">N</th>
<th id="T_60574_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">mu_x</th>
<th id="T_60574_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">mu_y</th>
<th id="T_60574_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">sigma_x</th>
<th id="T_60574_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">sigma_y</th>
<th id="T_60574_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">probabilidad</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_60574_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">316</td>
<td id="T_60574_row0_col0" class="data row0 col0">1.0e+03</td>
<td id="T_60574_row0_col1" class="data row0 col1">3</td>
<td id="T_60574_row0_col2" class="data row0 col2">3</td>
<td id="T_60574_row0_col3" class="data row0 col3">1</td>
<td id="T_60574_row0_col4" class="data row0 col4">1</td>
<td id="T_60574_row0_col5" class="data row0 col5">0.7630</td>
</tr>
<tr class="even">
<td id="T_60574_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">285</td>
<td id="T_60574_row1_col0" class="data row1 col0">1.0e+07</td>
<td id="T_60574_row1_col1" class="data row1 col1">2</td>
<td id="T_60574_row1_col2" class="data row1 col2">2</td>
<td id="T_60574_row1_col3" class="data row1 col3">1</td>
<td id="T_60574_row1_col4" class="data row1 col4">1</td>
<td id="T_60574_row1_col5" class="data row1 col5">0.7443</td>
</tr>
<tr class="odd">
<td id="T_60574_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">71</td>
<td id="T_60574_row2_col0" class="data row2 col0">1.0e+03</td>
<td id="T_60574_row2_col1" class="data row2 col1">-4</td>
<td id="T_60574_row2_col2" class="data row2 col2">-4</td>
<td id="T_60574_row2_col3" class="data row2 col3">1</td>
<td id="T_60574_row2_col4" class="data row2 col4">1</td>
<td id="T_60574_row2_col5" class="data row2 col5">0.5910</td>
</tr>
<tr class="even">
<td id="T_60574_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">106</td>
<td id="T_60574_row3_col0" class="data row3 col0">1.0e+03</td>
<td id="T_60574_row3_col1" class="data row3 col1">-3</td>
<td id="T_60574_row3_col2" class="data row3 col2">-3</td>
<td id="T_60574_row3_col3" class="data row3 col3">1</td>
<td id="T_60574_row3_col4" class="data row3 col4">1</td>
<td id="T_60574_row3_col5" class="data row3 col5">0.5110</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Y graficamos comparando con la <span class="math inline">\(F(x,y)\)</span></p>
<div id="6ef80d11" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> top_probs.drop(columns<span class="op">=</span>[<span class="st">'probabilidad'</span>]).values</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i, ax), param <span class="kw">in</span> <span class="bu">zip</span>(<span class="bu">enumerate</span>(axes.flatten()), params):</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    N, mu_x, mu_y, sigma_x, sigma_y <span class="op">=</span> param</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    plt.sca(ax)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># función para hacer subplot con los puntos de la distribución </span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bivariada y F</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    plot_bivariate_gaussian(mu_x, mu_y, sigma_x, sigma_y, N)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practica_1_files/figure-html/cell-12-output-1.png" width="949" height="948" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distribuciones-con-menor-probabilidad" class="level5">
<h5 class="anchored" data-anchor-id="distribuciones-con-menor-probabilidad">Distribuciones con menor probabilidad</h5>
<div id="5cf3884a" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>low_probs <span class="op">=</span> (</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    pd.DataFrame(frames)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">'probabilidad'</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    .drop_duplicates(subset<span class="op">=</span>[<span class="st">'mu_x'</span>,<span class="st">'mu_y'</span>,<span class="st">'sigma_x'</span>,<span class="st">'sigma_y'</span>])</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">4</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>low_probs.style.<span class="bu">format</span>({</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'probabilidad'</span>: <span class="st">'</span><span class="sc">{:.4f}</span><span class="st">'</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'N'</span>: <span class="st">'</span><span class="sc">{:.1e}</span><span class="st">'</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<style type="text/css">
</style>

<table id="T_9f079" class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th id="T_9f079_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">N</th>
<th id="T_9f079_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">mu_x</th>
<th id="T_9f079_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">mu_y</th>
<th id="T_9f079_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">sigma_x</th>
<th id="T_9f079_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">sigma_y</th>
<th id="T_9f079_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">probabilidad</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_9f079_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">420</td>
<td id="T_9f079_row0_col0" class="data row0 col0">1.0e+02</td>
<td id="T_9f079_row0_col1" class="data row0 col1">6</td>
<td id="T_9f079_row0_col2" class="data row0 col2">6</td>
<td id="T_9f079_row0_col3" class="data row0 col3">1</td>
<td id="T_9f079_row0_col4" class="data row0 col4">1</td>
<td id="T_9f079_row0_col5" class="data row0 col5">0.0000</td>
</tr>
<tr class="even">
<td id="T_9f079_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">178</td>
<td id="T_9f079_row1_col0" class="data row1 col0">1.0e+05</td>
<td id="T_9f079_row1_col1" class="data row1 col1">-1</td>
<td id="T_9f079_row1_col2" class="data row1 col2">-1</td>
<td id="T_9f079_row1_col3" class="data row1 col3">1</td>
<td id="T_9f079_row1_col4" class="data row1 col4">1</td>
<td id="T_9f079_row1_col5" class="data row1 col5">0.0089</td>
</tr>
<tr class="odd">
<td id="T_9f079_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">427</td>
<td id="T_9f079_row2_col0" class="data row2 col0">1.0e+02</td>
<td id="T_9f079_row2_col1" class="data row2 col1">6</td>
<td id="T_9f079_row2_col2" class="data row2 col2">6</td>
<td id="T_9f079_row2_col3" class="data row2 col3">2</td>
<td id="T_9f079_row2_col4" class="data row2 col4">2</td>
<td id="T_9f079_row2_col5" class="data row2 col5">0.0100</td>
</tr>
<tr class="even">
<td id="T_9f079_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">1</td>
<td id="T_9f079_row3_col0" class="data row3 col0">1.0e+03</td>
<td id="T_9f079_row3_col1" class="data row3 col1">-6</td>
<td id="T_9f079_row3_col2" class="data row3 col2">-6</td>
<td id="T_9f079_row3_col3" class="data row3 col3">1</td>
<td id="T_9f079_row3_col4" class="data row3 col4">1</td>
<td id="T_9f079_row3_col5" class="data row3 col5">0.0140</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="e50d0002" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> low_probs.drop(columns<span class="op">=</span>[<span class="st">'probabilidad'</span>]).values</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i, ax), param <span class="kw">in</span> <span class="bu">zip</span>(<span class="bu">enumerate</span>(axes.flatten()), params):</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    N, mu_x, mu_y, sigma_x, sigma_y <span class="op">=</span> param</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    plt.sca(ax)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># función para hacer subplot con los puntos de la distribución </span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bivariada y F</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    plot_bivariate_gaussian(mu_x, mu_y, sigma_x, sigma_y, N)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="practica_1_files/figure-html/cell-14-output-1.png" width="949" height="948" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretación" class="level5">
<h5 class="anchored" data-anchor-id="interpretación">Interpretación</h5>
<p>A pesar de que la probabilidad máxima con una distribución normal bivariada es <span class="math display">\[\mathbb{P}\left[(x, y) \in \mathcal{G} \mid (x, y) \sim \mathcal{N}(\mu_{xy}, \Sigma)\right] = 0.76,\]</span> esta aproximación no es muy confiable, ya que la región cubierta por la distribución es pequeña y se concentra solo en una parte específica de <span class="math inline">\(\mathcal{G}\)</span>. En contraste, aunque la probabilidad con una distribución uniforme es menor, <span class="math display">\[\mathbb{P}\left[(x, y) \in \mathcal{G} \mid (x, y) \sim \mathcal{U}(-6, 6) \times \mathcal{U}(-6, 6)\right] = 0.27,\]</span> esta distribución cubre toda el área de <span class="math inline">\(\mathcal{G}\)</span>, lo que resulta en una mejor estimación del área de <span class="math inline">\(F(x, y)\)</span>, ya que no se limita a una región específica.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>